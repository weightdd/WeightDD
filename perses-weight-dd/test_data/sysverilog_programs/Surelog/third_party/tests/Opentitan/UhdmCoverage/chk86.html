
<!DOCTYPE html>
<html>
<head>
<style>
body {

}
p {
font-size: 14px;
}</style>
<h3>hw/ip/usb_fs_nb_pe/rtl/usb_fs_nb_pe.sv Cov: 100% </h3>
<pre style="margin:0; padding:0 ">   1: // Copyright lowRISC contributors.</pre>
<pre style="margin:0; padding:0 ">   2: // Copyright Luke Valenty (TinyFPGA project)</pre>
<pre style="margin:0; padding:0 ">   3: // Licensed under the Apache License, Version 2.0, see LICENSE for details.</pre>
<pre style="margin:0; padding:0 ">   4: // SPDX-License-Identifier: Apache-2.0</pre>
<pre style="margin:0; padding:0 ">   5: </pre>
<pre style="margin:0; padding:0 ">   6: // USB Full Speed Non-Buffered Protocol Engine</pre>
<pre style="margin:0; padding:0 ">   7: //</pre>
<pre style="margin:0; padding:0 ">   8: // Decodes low level USB link protocol from external usb_fs_tx/rx</pre>
<pre style="margin:0; padding:0 ">   9: // Provides upper level with</pre>
<pre style="margin:0; padding:0 ">  10: // - OUT endpoint interface (host to device) which also covers SETUP</pre>
<pre style="margin:0; padding:0 ">  11: // - IN endpoint interface (device to host)</pre>
<pre style="margin:0; padding:0 ">  12: // - Start of Frame interface</pre>
<pre style="margin:0; padding:0 ">  13: //</pre>
<pre style="margin:0; padding:0 ">  14: // Based on usb_fs_pe.v from the TinyFPGA-Bootloader project but</pre>
<pre style="margin:0; padding:0 ">  15: // this version contains no packet buffers</pre>
<pre style="margin:0; padding:0 ">  16: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  17: module usb_fs_nb_pe #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  18:   parameter int unsigned NumOutEps = 2,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  19:   parameter int unsigned NumInEps = 2,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  20:   parameter int unsigned MaxPktSizeByte = 32,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  21:   parameter int unsigned PktW = $clog2(MaxPktSizeByte)</pre>
<pre style="margin:0; padding:0 ">  22: ) (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  23:   input  logic                   clk_48mhz_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  24:   input  logic                   rst_ni,        // Async. reset, active low</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  25:   input  logic                   link_reset_i,  // USB reset, sync to 48 MHz, active high</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  26:   input  logic [6:0]             dev_addr_i,</pre>
<pre style="margin:0; padding:0 ">  27: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  28:   input  logic                   cfg_eop_single_bit_i, // 1: detect a single SE0 bit as EOP</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  29:   input  logic                   tx_osc_test_mode_i, // Oscillator test mode (constantly output JK)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  30:   input  logic [NumOutEps-1:0]   data_toggle_clear_i, // Clear the data toggles for an EP</pre>
<pre style="margin:0; padding:0 ">  31: </pre>
<pre style="margin:0; padding:0 ">  32:   ////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  33:   // USB Endpoint Interface //</pre>
<pre style="margin:0; padding:0 ">  34:   ////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  35:   ///////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  36:   // global endpoint interface //</pre>
<pre style="margin:0; padding:0 ">  37:   ///////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  38: </pre>
<pre style="margin:0; padding:0 ">  39:   // out endpoint interfaces</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  40:   output logic [3:0]             out_ep_current_o, // Other signals address to this ep</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  41:   output logic                   out_ep_data_put_o, // put the data (put addr advances after)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  42:   output logic [PktW - 1:0]      out_ep_put_addr_o, // Offset to put data (0..pktlen)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  43:   output logic [7:0]             out_ep_data_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  44:   output logic                   out_ep_newpkt_o,// New OUT pkt start (with in_ep_current_o update)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  45:   output logic                   out_ep_acked_o, // good termination, device has acked</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  46:   output logic                   out_ep_rollback_o, // bad termination, discard data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  47:   output logic [NumOutEps-1:0]   out_ep_setup_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  48:   input  logic [NumOutEps-1:0]   out_ep_full_i, // Cannot accept data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  49:   input  logic [NumOutEps-1:0]   out_ep_stall_i, // Stalled</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  50:   input  logic [NumOutEps-1:0]   out_ep_iso_i, // Configure endpoint in isochronous mode</pre>
<pre style="margin:0; padding:0 ">  51: </pre>
<pre style="margin:0; padding:0 ">  52:   // in endpoint interfaces</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  53:   output logic [3:0]             in_ep_current_o, // Other signals addressed to this ep</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  54:   output logic                   in_ep_rollback_o, // Bad termination, rollback transaction</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  55:   output logic                   in_ep_acked_o, // good termination, transaction complete</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  56:   output logic [PktW - 1:0]      in_ep_get_addr_o, // Offset requested (0..pktlen)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  57:   output logic                   in_ep_data_get_o, // Accept data (get_addr advances too)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  58:   output logic                   in_ep_newpkt_o, // New IN pkt start (with in_ep_current_o update)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  59:   input  logic [NumInEps-1:0]    in_ep_stall_i, // Endpoint in a stall state</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  60:   input  logic [NumInEps-1:0]    in_ep_has_data_i, // Endpoint has data to supply</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  61:   input  logic [7:0]             in_ep_data_i, // Data for current get_addr</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  62:   input  logic [NumInEps-1:0]    in_ep_data_done_i, // Set when out of data</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  63:   input  logic  [NumInEps-1:0]   in_ep_iso_i, // Configure endpoint in isochronous mode</pre>
<pre style="margin:0; padding:0 ">  64: </pre>
<pre style="margin:0; padding:0 ">  65:   // sof interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  66:   output logic                   sof_valid_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  67:   output logic [10:0]            frame_index_o,</pre>
<pre style="margin:0; padding:0 ">  68: </pre>
<pre style="margin:0; padding:0 ">  69:   // RX errors</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  70:   output logic                   rx_crc_err_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  71:   output logic                   rx_pid_err_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  72:   output logic                   rx_bitstuff_err_o,</pre>
<pre style="margin:0; padding:0 ">  73: </pre>
<pre style="margin:0; padding:0 ">  74:   ///////////////////////////////////////</pre>
<pre style="margin:0; padding:0 ">  75:   // USB TX/RX Interface (synchronous) //</pre>
<pre style="margin:0; padding:0 ">  76:   ///////////////////////////////////////</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  77:   input  logic                   usb_d_i,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  78:   input  logic                   usb_se0_i,</pre>
<pre style="margin:0; padding:0 ">  79: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  80:   output logic                   usb_d_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  81:   output logic                   usb_se0_o,</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  82:   output logic                   usb_oe_o</pre>
<pre style="margin:0; padding:0 ">  83: );</pre>
<pre style="margin:0; padding:0 ">  84: </pre>
<pre style="margin:0; padding:0 ">  85:   import usb_consts_pkg::*;</pre>
<pre style="margin:0; padding:0 ">  86: </pre>
<pre style="margin:0; padding:0 ">  87:   // rx interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  88:   logic bit_strobe;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  89:   logic rx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  90:   logic rx_pkt_end;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  91:   logic [3:0] rx_pid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  92:   logic [6:0] rx_addr;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  93:   logic [3:0] rx_endp;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  94:   logic [10:0] rx_frame_num;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  95:   logic rx_data_put;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  96:   logic [7:0] rx_data;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 ">  97:   logic rx_pkt_valid;</pre>
<pre style="margin:0; padding:0 ">  98: </pre>
<pre style="margin:0; padding:0 ">  99:   // tx mux</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 100:   logic in_tx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 101:   logic [3:0] in_tx_pid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 102:   logic out_tx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 103:   logic [3:0] out_tx_pid;</pre>
<pre style="margin:0; padding:0 "> 104: </pre>
<pre style="margin:0; padding:0 "> 105:   // tx interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 106:   logic tx_pkt_start;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 107:   logic tx_pkt_end;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 108:   logic [3:0] tx_pid;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 109:   logic tx_data_avail;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 110:   logic tx_data_get;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 111:   logic [7:0] tx_data;</pre>
<pre style="margin:0; padding:0 "> 112: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 113:   logic usb_oe;</pre>
<pre style="margin:0; padding:0 "> 114: </pre>
<pre style="margin:0; padding:0 "> 115:   // sof interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 116:   assign sof_valid_o = rx_pkt_end & rx_pkt_valid & (usb_pid_e'(rx_pid) == UsbPidSof);</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 117:   assign frame_index_o = rx_frame_num;</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 118:   assign usb_oe_o = usb_oe;</pre>
<pre style="margin:0; padding:0 "> 119: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 120:   usb_fs_nb_in_pe #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 121:     .NumInEps           (NumInEps),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 122:     .MaxInPktSizeByte   (MaxPktSizeByte)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 123:   ) u_usb_fs_nb_in_pe (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 124:     .clk_48mhz_i           (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 125:     .rst_ni                (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 126:     .link_reset_i          (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 127:     .dev_addr_i            (dev_addr_i),</pre>
<pre style="margin:0; padding:0 "> 128: </pre>
<pre style="margin:0; padding:0 "> 129:     // endpoint interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 130:     .in_ep_current_o       (in_ep_current_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 131:     .in_ep_rollback_o      (in_ep_rollback_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 132:     .in_ep_acked_o         (in_ep_acked_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 133:     .in_ep_get_addr_o      (in_ep_get_addr_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 134:     .in_ep_data_get_o      (in_ep_data_get_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 135:     .in_ep_newpkt_o        (in_ep_newpkt_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 136:     .in_ep_stall_i         (in_ep_stall_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 137:     .in_ep_has_data_i      (in_ep_has_data_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 138:     .in_ep_data_i          (in_ep_data_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 139:     .in_ep_data_done_i     (in_ep_data_done_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 140:     .in_ep_iso_i           (in_ep_iso_i),</pre>
<pre style="margin:0; padding:0 "> 141: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 142:     .data_toggle_clear_i   (data_toggle_clear_i),</pre>
<pre style="margin:0; padding:0 "> 143: </pre>
<pre style="margin:0; padding:0 "> 144:     // rx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 145:     .rx_pkt_start_i        (rx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 146:     .rx_pkt_end_i          (rx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 147:     .rx_pkt_valid_i        (rx_pkt_valid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 148:     .rx_pid_i              (rx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 149:     .rx_addr_i             (rx_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 150:     .rx_endp_i             (rx_endp),</pre>
<pre style="margin:0; padding:0 "> 151: </pre>
<pre style="margin:0; padding:0 "> 152:     // tx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 153:     .tx_pkt_start_o        (in_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 154:     .tx_pkt_end_i          (tx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 155:     .tx_pid_o              (in_tx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 156:     .tx_data_avail_o       (tx_data_avail),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 157:     .tx_data_get_i         (tx_data_get),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 158:     .tx_data_o             (tx_data)</pre>
<pre style="margin:0; padding:0 "> 159:   );</pre>
<pre style="margin:0; padding:0 "> 160: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 161:   usb_fs_nb_out_pe #(</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 162:     .NumOutEps           (NumOutEps),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 163:     .MaxOutPktSizeByte   (MaxPktSizeByte)</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 164:   ) u_usb_fs_nb_out_pe (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 165:     .clk_48mhz_i            (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 166:     .rst_ni                 (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 167:     .link_reset_i           (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 168:     .dev_addr_i             (dev_addr_i),</pre>
<pre style="margin:0; padding:0 "> 169: </pre>
<pre style="margin:0; padding:0 "> 170:     // endpoint interface</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 171:     .out_ep_current_o       (out_ep_current_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 172:     .out_ep_data_put_o      (out_ep_data_put_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 173:     .out_ep_put_addr_o      (out_ep_put_addr_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 174:     .out_ep_data_o          (out_ep_data_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 175:     .out_ep_newpkt_o        (out_ep_newpkt_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 176:     .out_ep_acked_o         (out_ep_acked_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 177:     .out_ep_rollback_o      (out_ep_rollback_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 178:     .out_ep_setup_o         (out_ep_setup_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 179:     .out_ep_full_i          (out_ep_full_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 180:     .out_ep_stall_i         (out_ep_stall_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 181:     .out_ep_iso_i           (out_ep_iso_i),</pre>
<pre style="margin:0; padding:0 "> 182: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 183:     .data_toggle_clear_i    (data_toggle_clear_i),</pre>
<pre style="margin:0; padding:0 "> 184: </pre>
<pre style="margin:0; padding:0 "> 185:     // rx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 186:     .rx_pkt_start_i         (rx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 187:     .rx_pkt_end_i           (rx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 188:     .rx_pkt_valid_i         (rx_pkt_valid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 189:     .rx_pid_i               (rx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 190:     .rx_addr_i              (rx_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 191:     .rx_endp_i              (rx_endp),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 192:     .rx_data_put_i          (rx_data_put),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 193:     .rx_data_i              (rx_data),</pre>
<pre style="margin:0; padding:0 "> 194: </pre>
<pre style="margin:0; padding:0 "> 195:     // tx path</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 196:     .tx_pkt_start_o         (out_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 197:     .tx_pkt_end_i           (tx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 198:     .tx_pid_o               (out_tx_pid)</pre>
<pre style="margin:0; padding:0 "> 199:   );</pre>
<pre style="margin:0; padding:0 "> 200: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 201:   usb_fs_rx u_usb_fs_rx (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 202:     .clk_i                  (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 203:     .rst_ni                 (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 204:     .link_reset_i           (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 205:     .cfg_eop_single_bit_i   (cfg_eop_single_bit_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 206:     .usb_d_i                (usb_d_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 207:     .usb_se0_i              (usb_se0_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 208:     .tx_en_i                (usb_oe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 209:     .bit_strobe_o           (bit_strobe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 210:     .pkt_start_o            (rx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 211:     .pkt_end_o              (rx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 212:     .pid_o                  (rx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 213:     .addr_o                 (rx_addr),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 214:     .endp_o                 (rx_endp),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 215:     .frame_num_o            (rx_frame_num),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 216:     .rx_data_put_o          (rx_data_put),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 217:     .rx_data_o              (rx_data),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 218:     .valid_packet_o         (rx_pkt_valid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 219:     .crc_error_o            (rx_crc_err_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 220:     .pid_error_o            (rx_pid_err_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 221:     .bitstuff_error_o       (rx_bitstuff_err_o)</pre>
<pre style="margin:0; padding:0 "> 222:   );</pre>
<pre style="margin:0; padding:0 "> 223: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 224:   usb_fs_tx_mux u_usb_fs_tx_mux (</pre>
<pre style="margin:0; padding:0 "> 225:     // interface to IN Protocol Engine</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 226:     .in_tx_pkt_start_i  (in_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 227:     .in_tx_pid_i        (in_tx_pid),</pre>
<pre style="margin:0; padding:0 "> 228: </pre>
<pre style="margin:0; padding:0 "> 229:     // interface to OUT Protocol Engine</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 230:     .out_tx_pkt_start_i (out_tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 231:     .out_tx_pid_i       (out_tx_pid),</pre>
<pre style="margin:0; padding:0 "> 232: </pre>
<pre style="margin:0; padding:0 "> 233:     // interface to tx module</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 234:     .tx_pkt_start_o     (tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 235:     .tx_pid_o           (tx_pid)</pre>
<pre style="margin:0; padding:0 "> 236:   );</pre>
<pre style="margin:0; padding:0 "> 237: </pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 238:   usb_fs_tx u_usb_fs_tx (</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 239:     .clk_i                  (clk_48mhz_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 240:     .rst_ni                 (rst_ni),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 241:     .link_reset_i           (link_reset_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 242:     .tx_osc_test_mode_i     (tx_osc_test_mode_i),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 243:     .bit_strobe_i           (bit_strobe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 244:     .usb_d_o                (usb_d_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 245:     .usb_se0_o              (usb_se0_o),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 246:     .usb_oe_o               (usb_oe),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 247:     .pkt_start_i            (tx_pkt_start),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 248:     .pkt_end_o              (tx_pkt_end),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 249:     .pid_i                  (tx_pid),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 250:     .tx_data_avail_i        (tx_data_avail),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 251:     .tx_data_get_o          (tx_data_get),</pre>
<pre style="background-color: #C0C0C0; margin:0; padding:0 "> 252:     .tx_data_i              (tx_data)</pre>
<pre style="margin:0; padding:0 "> 253:   );</pre>
<pre style="margin:0; padding:0 "> 254: endmodule</pre>
<pre style="margin:0; padding:0 "> 255: </pre>
</body>
</html>
